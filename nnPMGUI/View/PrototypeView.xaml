<UserControl x:Class="NnManagerGUI.View.PrototypeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
             xmlns:local="clr-namespace:NnManagerGUI"
             xmlns:vw="clr-namespace:NnManagerGUI.View"
             xmlns:vm="clr-namespace:NnManagerGUI.ViewModel"
             mc:Ignorable="d" Height="547" Width="790">
    <UserControl.DataContext>
        <vm:ProjectViewModel/>
    </UserControl.DataContext>
    <Grid Background="White">
        <Button Content="New Project" 
                HorizontalAlignment="Left" 
                Margin="13,10,0,0" 
                VerticalAlignment="Top" 
                Width="93"
                Height="40"                
                Command="{Binding NewProject}"/>
        <Button Content="Add Template"
                HorizontalAlignment="Left" 
                Margin="13,79,0,0" 
                VerticalAlignment="Top" 
                Width="133"
                Height="55"
                Command="{Binding AddTemplate}"/>
        <Button Content="Add Task"
                HorizontalAlignment="Left" 
                Margin="251,91,0,0" 
                VerticalAlignment="Top" 
                Width="104"
                Height="43"
                Command="{Binding AddTask}"/>
        <ListBox HorizontalAlignment="Left" 
                 Height="192" 
                 Margin="13,144,0,0" 
                 VerticalAlignment="Top" 
                 Width="219"
                 ItemsSource="{Binding TemplateCollection, Mode=OneWay}"
                 SelectedItem="{Binding SelectedTemplateId, Mode=TwoWay}"/>
        <!-- ListBox HorizontalAlignment="Left" 
                 Height="182" 
                 Margin="13,341,0,0" 
                 VerticalAlignment="Top" 
                 Width="219"
                 ItemsSource="{Binding TemplateInfoCollection, Mode=OneWay}"
                 SelectedItem="{Binding SelectedTemplateInfoId, Mode=OneWayToSource}"/-->
        <DataGrid HorizontalAlignment="Left" 
		          Height="182" 
		          Margin="13,341,0,0" 
		          VerticalAlignment="Top" 
		          Width="219"
		          AutoGenerateColumns="False"
		          ItemsSource="{
			        Binding ParamCollection, 
			        Mode=TwoWay, 
			        UpdateSourceTrigger=PropertyChanged
			      }"
		          CellEditEnding="ParamDataGrid_CellEditEnding">
            <DataGrid.Columns>
                <DataGridTextColumn 
				  Width="*"
				  Header="Name" 
				  IsReadOnly="True"  
				  Binding="{Binding Name}"/>
                <DataGridTextColumn 
				  Width="*"
				  Header="Value" 
				  Binding="{
					Binding Value, 
					Mode=TwoWay,
					UpdateSourceTrigger=PropertyChanged
				  }"/>
                <DataGridTextColumn 
				  Width="*"
				  Header="Default"  
				  IsReadOnly="True" 
				  Binding="{Binding DefaultValue}"/>
            </DataGrid.Columns>
        </DataGrid>
        <DataGrid Margin="251,144,0,0"
                 Height="327" VerticalAlignment="Top" HorizontalAlignment="Left" Width="508"
		          AutoGenerateColumns="False"
                 ItemsSource="{Binding TaskCollection, Mode=OneWay}"
                 SelectedItem="{Binding SelectedTask}"
                 MouseDoubleClick="TaskDataGrid_MouseDoubleClick">
            <!--<DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding State}" Value="Queued">
                            <Setter Property="Background" Value="LightGreen"></Setter>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding State}" Value="Idle">
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>-->
            <DataGrid.Columns>
                <DataGridTemplateColumn 
                    Width="0.2*"
                    Header="Name" 
		            IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock 
                                Text="{Binding Name}" 
                                ToolTip="{Binding Name}"
                                TextTrimming="CharacterEllipsis"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn 
                    Width="0.3*"
                    Header="Modules" 
		            IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock>
                                <TextBlock.Inlines>
                                    <Run FontWeight="Bold"
                                         Text="{Binding RunningModule}" />
                                    <Run Foreground="Gray"
                                         Text="{Binding QueuedModule}" />
                            </TextBlock.Inlines>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn 
                    Width="0.5*"
                    Header="Status" 
		            IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock 
                                Text="{Binding Status}" 
                                ToolTip="{Binding Status}"
                                TextTrimming="CharacterEllipsis"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        <Button Content="Start" 
                HorizontalAlignment="Left" 
                Margin="599,485,0,0" 
                VerticalAlignment="Top" 
                Width="75"
                Command="{Binding StartQueue}"/>
        <Button Content="Stop" 
                HorizontalAlignment="Left" 
                Margin="689,485,0,0" 
                VerticalAlignment="Top" 
                Width="75"
                Command="{Binding StopQueue}"/>
        <Label Content="{Binding SchedularStatus, Mode=OneWay}" 
               HorizontalAlignment="Left" 
               Margin="689,513,0,0" 
               VerticalAlignment="Top"/>
        <Button
            Content="Test Task"
            HorizontalAlignment="Left" 
            Margin="388,24,0,0" 
            VerticalAlignment="Top" 
            Width="104"
            Height="43"
            Command="{Binding EnqueueTestTask}"/>
        <!--<ListBox
            Margin="522,144,0,0"
            Height="327" VerticalAlignment="Top" HorizontalAlignment="Left" Width="237"
            ItemsSource="{Binding QueuedTaskCollection, Mode=OneWay}"/>-->
        <!--<Button
            Content="Save Project" 
            HorizontalAlignment="Left" 
            Margin="139,10,0,0" 
            VerticalAlignment="Top" 
            Width="93"
            Height="40"
            Command="{Binding SaveProject}"/>-->
        <Button
            Content="Load Project" 
            HorizontalAlignment="Left" 
            Margin="139,10,0,0" 
            VerticalAlignment="Top" 
            Width="93"
            Height="40"
            Command="{Binding LoadProject}"/>
        <ScrollViewer Margin="497,0,0.4,413.2">
            <TextBlock 
		  HorizontalAlignment="Left"
		  TextWrapping="Wrap" 
		  VerticalAlignment="Top" 
		  Text="{Binding LogText, Mode=OneWay}"/>
        </ScrollViewer>
        <Button Content="Load param from task"
	  HorizontalAlignment="Left" 
	  Margin="251,478,0,0" 
	  VerticalAlignment="Top" 
	  Width="145"
	  Height="43"
	  Command="{Binding LoadParamFromTask}"/>
        <Button
            Content="Test Anal. Task"
            HorizontalAlignment="Left" 
            Margin="388,91,0,0" 
            VerticalAlignment="Top" 
            Width="104"
            Height="43"
            Command="{Binding EnqueueTestAnalTask}"/>
    </Grid>
</UserControl>
